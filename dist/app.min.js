function e(){music.paused||(document.querySelector(".button-sound").dataset.mute="false")}function t(e){var t=_.content,n=_.currentDressSlider,a=document.querySelector(".sliders__slider:nth-child(".concat(n,")")),i=document.querySelector(".content__section:nth-child(".concat(n,")"));switch(e){case 12:t?d({targets:i}):r({targets:a}),function(){var e=document.querySelectorAll(".menu__item span"),t=document.querySelector(".menu");anime({targets:e,opacity:[0,1],delay:800,duration:1600,easing:"easeInExpo",begin:function(){t.style.visibility="visible",t.style.display="flex"},complete:function(){_.scroll=!1,_.menu=!0}})}();break;case 13:t?s(i):o({targets:a,delay:1200}),l()}}function n(e){var t=6===e||7===e?1:8===e||9===e?2:3,n=document.querySelector(".sliders__slider:nth-child(".concat(t,")")),a=document.querySelector(".content__section:nth-child(".concat(t,")"));switch(e){case 6:case 8:case 10:r({targets:n}),s(a);break;case 7:case 9:case 11:o({targets:n,delay:300}),d({targets:a})}}function a(e,t){var n;n="next"===t?0===e||1===e?1:2===e||3===e?2:3===e||4===e||5===e?3:"":0===e?1:1===e||2===e?2:3===e||4===e?3:"";var a=document.querySelector(".sliders__slider:nth-child(".concat(n,")"));switch(e){case 0:o({targets:a});break;case 1:r({targets:a});break;case 2:o({targets:a});break;case 3:r({targets:a});break;case 4:o({targets:a});break;case 5:r({targets:a})}}function i(){var e=document.querySelector(".sliders__slider:first-child");anime({targets:e,duration:400,opacity:0,easing:"easeInQuint",complete:function(){e.remove(),o({targets:document.querySelector(".sliders__slider:first-child"),onComplete:function(){_.scroll=!0}})}}),anime({targets:".button-sound, .burger, .logo",duration:400,delay:3800,opacity:1,easing:"easeInOutExpo"})}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.targets,n=e.onBegin,a=void 0!==n&&n,i=e.onComplete,r=void 0!==i&&i,o=t.querySelectorAll(".sliders__title span"),s=t.querySelectorAll(".sliders__count, button"),d=document.querySelector(".scroll");anime({targets:o,duration:600,delay:0,easing:"easeInOutExpo",opacity:[1,0],begin:function(){t.style.opacity="1",a&&a()},complete:function(){t.classList.remove("active"),r&&r()}}),anime({targets:[s,d],duration:600,delay:0,easing:"easeInOutExpo",opacity:[1,0]})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.targets,n=e.delay,a=void 0===n?2200:n,i=e.onBegin,r=void 0!==i&&i,o=e.onComplete,s=void 0!==o&&o,d=t.querySelectorAll(".sliders__title span"),l=t.querySelectorAll(".sliders__count, button"),c=document.querySelector(".scroll");anime({targets:d,duration:700,delay:function(e,t){return a+50*t},easing:"easeOutCirc",opacity:[0,1],translateX:function(e,t){return[50+10*t,0]},begin:function(){t.style.opacity="1",r&&r()},complete:function(){t.classList.add("active"),_.scroll=!0,_.content=!1,s&&s()}}),anime({targets:[l,c],duration:400,delay:a+1200,easing:"easeInOutExpo",opacity:[0,1]})}function s(e){var t=document.querySelector(".content");anime({targets:e,opacity:[0,1],delay:600,duration:1600,easing:"easeInExpo",begin:function(){t.style.visibility="visible",e.style.display="block"},complete:function(){e.classList.add("active"),_.scroll=!1,_.content=!0}})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.targets,n=e.onComplete,a=void 0!==n&&n,i=document.querySelector(".content");anime({targets:t,opacity:[1,0],duration:600,easing:"easeOutExpo",complete:function(){i.style.visibility="hidden",t.style.display="none",t.classList.remove("active"),a&&a()}})}function l(){var e=document.querySelectorAll(".menu__item span"),t=document.querySelector(".menu");anime({targets:e,opacity:[1,0],delay:0,duration:1600,easing:"easeOutExpo",complete:function(){t.style.visibility="hidden",t.style.display="none",_.menu=!1}})}e(),music.volume=.1,soundin.volume=1,soundout.volume=1,document.querySelectorAll(".sliders__slider, .menu__item").forEach((function(e){return charming(e)}));var c=new THREE.PointLight(16777215,.14);c.position.set(-7,3,2);var u=new THREE.PointLight(16777215,.12);u.position.set(3.1,1.867,-1.282);var p=new THREE.PointLight(16777215,.14);p.position.set(-4.116,-.967,2.631);var m,y,f,R,g,h,E,v,b,w=new THREE.MeshPhysicalMaterial({color:new THREE.Color("#f3b0c2"),emissive:new THREE.Color("#f3b0c2"),emissiveIntensity:.35,metalness:.35,morphTargets:!0,roughness:.5,clearcoat:0,clearcoatRoughness:.1,reflectivity:1,side:THREE.DoubleSide}),x=document.querySelector(".app"),Y=new THREE.Clock,S=window.innerWidth/2,z=window.innerHeight/2,P={cameraX:-.134952,cameraY:3.965744,targetX:0,targetY:0,ease:.002,ampX:.075,ampY:.015},C=[],X={playing:!1,playStars:function(){this.playing&&soundin.play()},playWind:function(){this.playing&&soundout.play()},setPlay:function(){music.play(),e(),this.playing=!0},setPause:function(){music.pause(),e(),this.playing=!1}},_={index:-1,prevIndex:null,currentDressSlider:null,content:!1,menu:!1,prevCameraPosition:{endX:null,endY:null,endZ:null,endRX:null,endRY:null,endRZ:null},playing:!1,scroll:!1,next:[[1,2],[3,4],[5,0]],prev:[[1,0],[3,2],[5,4]]},k={mixer:[],animations:[]},T=(g=I,h=300,b=!1,function e(){if(b)return E=arguments,void(v=this);g.apply(this,arguments),b=!0,setTimeout((function(){b=!1,E&&(e.apply(v,E),E=v=null)}),h)}),H=[{startX:-.134952,startY:3.965744,startZ:.182446,endX:-.89,endY:3.024656,endZ:1.1617089999999999,startRX:.013290999999999999,startRY:-.852159,startRZ:-.090948,endRX:-.117688,endRY:-.6060749999999999,endRZ:-.076337,objStartRY:0,objEndRY:8.6,duration:4e3,cubicBezier:"0.055, 0.450, 0.475, 0.765",particles:3},{startX:-.9636509999999999,startY:3.024656,startZ:1.1617089999999999,endX:.017736,endY:2.1849369999999997,endZ:-.090921,startRX:-.11115,startRY:-.641532,startRZ:-.06630699999999999,endRX:-.339515,endRY:-.8219799999999999,endRZ:-.212728,objStartRY:8.6,objEndRY:0,obj3StartRY:0,obj3EndRY:8.6,duration:1500,cubicBezier:"0.765, 0.325, 0.280, 0.800"},{startX:.017736,startY:2.1849369999999997,startZ:-.090921,endX:.028704,endY:1.122112,endZ:1.289866,startRX:-.339515,startRY:-.8219799999999999,startRZ:-.212728,endRX:-.044142999999999995,endRY:.03624,endRZ:.015323,obj3StartRY:8.6,obj3EndRY:0,duration:4e3,cubicBezier:"0.055, 0.450, 0.475, 0.765",particles:4},{startX:.028704,startY:1.122112,startZ:1.289866,endX:.186173,endY:.48657,endZ:-.087522,startRX:-.044142999999999995,startRY:.03624,startRZ:.015323,endRX:-.161496,endRY:.13526,endRZ:-.00245,obj3StartRY:0,obj3EndRY:8.6,obj2StartRY:9.6,obj2EndRY:0,duration:1500,cubicBezier:"0.765, 0.325, 0.280, 0.800"},{startX:.186173,startY:.48657,startZ:-.087522,endX:.086828,endY:-.818143,endZ:1.346854,startRX:-.161496,startRY:.13526,startRZ:-.00245,endRX:.019832,endRY:.083074,endRZ:185e-6,obj2StartRY:0,obj2EndRY:9.6,duration:4e3,cubicBezier:"0.055, 0.450, 0.475, 0.765",particles:5},{startX:.086828,startY:-.818143,startZ:1.346854,endX:-.05933848738366905,endY:-1.6314853361009416,endZ:-.038750361730078176,startRX:.019832,startRY:.083074,startRZ:185e-6,endRX:-.09335365157235163,endRY:.09579747424262565,endRZ:.0011175874673510107,obj2StartRY:9.6,obj2EndRY:0,duration:1500,cubicBezier:"0.765, 0.325, 0.280, 0.800"},{duration:2500,x:.25,z:-.35,y:0,cubicBezier:"0.055, 0.450, 0.475, 0.765"},{duration:1900,x:-.25,z:.35,y:0,cubicBezier:"0.765, 0.325, 0.280, 0.800"},{duration:2500,x:0,z:-.35,y:0,cubicBezier:"0.055, 0.450, 0.475, 0.765"},{duration:1900,x:0,z:.35,y:0,cubicBezier:"0.765, 0.325, 0.280, 0.800"},{duration:2500,x:0,z:-.35,y:0,cubicBezier:"0.055, 0.450, 0.475, 0.765"},{duration:1900,x:0,z:.35,y:0,cubicBezier:"0.765, 0.325, 0.280, 0.800"},{duration:2500,x:-1,z:-2,y:0,rx:-.5,ry:.4,rz:.3,cubicBezier:"0.765, 0.325, 0.280, 0.800"},{duration:2500,cubicBezier:"0.765, 0.325, 0.280, 0.800"}];function Z(){}function q(){m.aspect=window.innerWidth/window.innerHeight,m.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight)}function A(e,r){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=H[e],d=_[r],l=_.menu,c=null;d.forEach((function(t){t[0]===e&&(c=t[1])}));var u=[6,8,10].includes(e),p=[7,9,11].includes(e),f=12===e,R=13===e,g=[0,2,4],h=g.includes(e),E=[1,3,5].includes(e),v=[];y.children.forEach((function(e,t){return"BezierCircle"===e.name?v.push(t):""})),o?i():u||p?n(e):f||R?t(e):l&&E||a(e,r);var b=0===e&&"next"===r?s.startX:m.position.x,w=0===e&&"next"===r?s.startY:m.position.y,x=0===e&&"next"===r?s.startZ:m.position.z,Y=0===e&&"next"===r?s.startRX:m.rotation.x,S=0===e&&"next"===r?s.startRY:m.rotation.y,z=0===e&&"next"===r?s.startRZ:m.rotation.z;if(s.particles&&h||s.particles&&f){var k=s.particles,T=C[k];T?T.reset():L(s.particles)}if((u||p||f||R)&&(s.endRX=m.rotation.x,s.endRY=m.rotation.y,s.endRZ=m.rotation.z,s.objStartRY=s.objEndRY=y.children[v[0]].rotation.y,s.obj2StartRY=s.obj2EndRY=y.children[v[1]].rotation.y,s.obj3StartRY=s.obj3EndRY=y.children[v[2]].rotation.y),(u||p||f)&&(s.endX=m.position.x+s.x,s.endY=m.position.y+s.y,s.endZ=m.position.z+s.z),f){var Z=s.rx,q=s.ry,M=s.rz;s.endRX=m.rotation.x+Z,s.endRY=m.rotation.y+q,s.endRZ=m.rotation.z+M}if(R){var j=_.prevCameraPosition,B=j.endX,I=j.endY,W=j.endZ,O=j.endRX,D=j.endRY,U=j.endRZ;s.endX=B,s.endY=I,s.endZ=W,s.endRX=O,s.endRY=D,s.endRZ=U}anime.timeline({easing:"cubicBezier(".concat(s.cubicBezier,")"),duration:s.duration,begin:function(){P.targetX=0,P.targetY=0,P.cameraX=s.endX,P.cameraY=s.endY,h&&X.playStars(),E&&!l&&X.playWind(),f&&X.playWind(),_.playing=!0},complete:function(){_.playing=!1,_.index=e,h&&(_.currentDressSlider=g.indexOf(e)+1),null!==c&&A(c,r)}}).add({targets:m.position,x:[b,s.endX],y:[w,s.endY],z:[x,s.endZ]},0).add({targets:m.rotation,x:[Y,s.endRX],y:[S,s.endRY],z:[z,s.endRZ]},0).add({targets:y.children[v[0]].rotation,y:[s.objStartRY,s.objEndRY]},0).add({targets:y.children[v[1]].rotation,y:[s.obj2StartRY,s.obj2EndRY]},0).add({targets:y.children[v[2]].rotation,y:[s.obj3StartRY,s.obj3EndRY]},0)}function L(e){if(6===e){var t=m.position.y,n=m.position.x-1,a=m.position.x;C.push(new Partykals.ParticlesSystem({container:y,particles:{offset:new Partykals.Randomizers.SphereRandomizer(.2,.8),startAlpha:1,endAlpha:0,size:new Partykals.Randomizers.MinMaxRandomizer(.017,.027),startAlphaChangeAt:0,ttl:15.5,globalColor:new THREE.Color("#feeaf4"),endColor:new THREE.Color("#ffffff"),worldPosition:!0,blending:"additive",texture:(new THREE.TextureLoader).load("/homepage/img/particle.png")},system:{particlesCount:500,emitters:new Partykals.Emitter({onInterval:500,interval:.2}),ttl:15.5,speed:1,onUpdate:function(e){e.particleSystem.position.y=t,e.particleSystem.position.z=n,e.particleSystem.position.x=a,e.particleSystem.rotation.x+=e.dt/10}}}))}else{var i=3===e?3.2:4===e?1.4:-.6;C.push(new Partykals.ParticlesSystem({container:y,particles:{offset:new Partykals.Randomizers.SphereRandomizer(.2,.8),startAlpha:1,endAlpha:0,size:new Partykals.Randomizers.MinMaxRandomizer(.017,.027),startAlphaChangeAt:0,ttl:5.5,globalColor:new THREE.Color("#feeaf4"),endColor:new THREE.Color("#ffffff"),worldPosition:!0,blending:"additive",texture:(new THREE.TextureLoader).load("/homepage/img/particle.png")},system:{particlesCount:500,emitters:new Partykals.Emitter({onInterval:500,interval:.2}),ttl:5.5,speed:1,onUpdate:function(e){e.particleSystem.position.y=i,e.particleSystem.position.z=0,e.particleSystem.position.x=0,e.particleSystem.rotation.y+=e.dt/10}}}))}}document.addEventListener("mousemove",(function(e){P.targetX=e.clientX/S*P.ampX+P.cameraX,P.targetY=e.clientY/z*P.ampY+P.cameraY}),!1),function(){(m=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,100)).position.set(-.134952,3.965744,.182446),m.rotation.set(.013290999999999999,-.852159,-.090948),(y=new THREE.Scene).background=new THREE.Color("#fff7fe"),R=new THREE.AmbientLight(16777215,.8),y.add(R),y.add(c),y.add(u),y.add(p),(new THREE.TextureLoader).load("/homepage/img/map3.jpg",(function(e){var t=new THREE.CylinderBufferGeometry(6,6,15,32),n=new THREE.MeshBasicMaterial({color:new THREE.Color("#fff7fe"),side:THREE.BackSide,map:e}),a=new THREE.Mesh(t,n);y.add(a)}));var e={loaded:0},t=function(t){var n=t.loaded,a=t.total;document.querySelector(".sliders__loading__count");if(a===n&&e.loaded++,3===e.loaded){var i=document.querySelector(".start"),r=document.querySelector(".sliders__loading");i.style.opacity=1,r.style.opacity=0}},n=new THREE.GLTFLoader;Promise.all(["/homepage/3d/Ткань.glb","/homepage/3d/Ткань2.glb","/homepage/3d/Ткань3.glb"].map((function(e){return new Promise((function(a,i){n.load(e,a,t,i)}))}))).then((function(e){e.forEach((function(e,t){e.scene.children.forEach((function(n){if("Mesh"===n.type){n.scale.x=2===t?.16:.1,n.scale.y=2===t?.16:.1,n.scale.z=2===t?.16:.1;if(n.position.y=[1.8890719999999999,-1.8699999999999999,.25][t],2===t){n.position.x=.19999999999999998}n.material=w,y.add(n),k.mixer.push(new THREE.AnimationMixer(n)),k.animations.push(e.animations)}}))})),k.animations.forEach((function(e,t){e.forEach((function(e){k.mixer[t].clipAction(e).reset().play()}))})),window.addEventListener("wheel",T),document.querySelector(".sliders").addEventListener("touchstart",j),document.querySelector(".sliders").addEventListener("touchmove",B)})),(f=new THREE.WebGLRenderer({antialias:!0,physicallyCorrectLights:!0})).setPixelRatio(window.devicePixelRatio),f.setSize(window.innerWidth,window.innerHeight),f.gammaFactor=2.2,f.gammaOutput=!0,x.appendChild(f.domElement),C.push(new Partykals.ParticlesSystem({container:y,particles:{startAlpha:1,endAlpha:0,size:new Partykals.Randomizers.MinMaxRandomizer(.045,.055),startAlphaChangeAt:0,ttl:7,offset:new Partykals.Randomizers.SphereRandomizer(5,5),globalColor:new THREE.Color("#feeaf4"),endColor:new THREE.Color("#ffffff"),worldPosition:!0,blending:"additive",texture:(new THREE.TextureLoader).load("/homepage/img/particle.png")},system:{particlesCount:2500,depthWrite:!1,emitters:new Partykals.Emitter({onInterval:new Partykals.Randomizers.MinMaxRandomizer(300,500),interval:new Partykals.Randomizers.MinMaxRandomizer(.2,.8)}),speed:1,onUpdate:function(e){e.particleSystem.rotation.y+=e.dt/300}}})),C.push(new Partykals.ParticlesSystem({container:y,particles:{startAlpha:1,endAlpha:0,size:new Partykals.Randomizers.MinMaxRandomizer(.045,.055),startAlphaChangeAt:0,ttl:7,offset:new Partykals.Randomizers.SphereRandomizer(4.2,4.2),globalColor:new THREE.Color("#feeaf4"),endColor:new THREE.Color("#ffffff"),worldPosition:!0,blending:"additive",texture:(new THREE.TextureLoader).load("/homepage/img/particle.png")},system:{particlesCount:1500,depthWrite:!1,emitters:new Partykals.Emitter({onInterval:new Partykals.Randomizers.MinMaxRandomizer(300,500),interval:new Partykals.Randomizers.MinMaxRandomizer(.2,.8)}),speed:1,onUpdate:function(e){e.particleSystem.rotation.y+=e.dt/100}}})),C.push(new Partykals.ParticlesSystem({container:y,particles:{startAlpha:1,endAlpha:0,size:new Partykals.Randomizers.MinMaxRandomizer(.045,.055),startAlphaChangeAt:0,ttl:7,offset:new Partykals.Randomizers.SphereRandomizer(3.8,3.8),globalColor:new THREE.Color("#feeaf4"),endColor:new THREE.Color("#ffffff"),worldPosition:!0,blending:"additive",texture:(new THREE.TextureLoader).load("/homepage/img/particle.png")},system:{particlesCount:1e3,depthWrite:!1,emitters:new Partykals.Emitter({onInterval:new Partykals.Randomizers.MinMaxRandomizer(300,500),interval:new Partykals.Randomizers.MinMaxRandomizer(.2,.8)}),speed:1,onUpdate:function(e){e.particleSystem.rotation.y+=e.dt/200}}})),window.addEventListener("resize",q,!1),document.addEventListener("visibilitychange",Z,!1)}(),function e(){requestAnimationFrame(e),function(){var e=Y.getDelta(),t=_.playing;k.mixer&&k.animations&&k.mixer.forEach((function(t){return t.update(e/2)}));t||0!==P.targetX&&0!==P.targetY&&(m.position.x+=(P.targetX-m.position.x)*P.ease*16,m.position.y+=(P.targetY-m.position.y)*P.ease*16);C.forEach((function(e){return e.update()})),f.render(y,m)}()}();var M=0;function j(e){M=e.touches[0].pageY}function B(e){I({deltaY:M-e.touches[0].pageY})}function I(e){var t=_.playing,n=_.scroll,a=_.currentDressSlider;if(!t&&n){var i,r;switch(a){case 1:i=1,r=null;break;case 2:i=3,r=1;break;case 3:i=5,r=3}1===Math.sign(e.deltaY)?A(i,"next"):A(r,"prev")}}function W(e){if(!_.playing){var t=U(e.target.closest(".sliders__slider"));A(0===t?6:1===t?8:10,"next")}}function O(e){if(!_.playing){var t=U(e.target.closest(".content__section"));A(0===t?7:1===t?9:11,"next")}}function D(e){var t=_.playing,n=_.index;if(!t){_.prevIndex=n;var a=U(e.target.closest(".menu__item")),i=0===a?5:1===a?1:3;document.querySelector(".burger").classList.remove("burger_opened"),l(),A(i,"next")}}function U(e){for(var t=0;e=e.previousElementSibling;)t++;return t}document.querySelector(".button-sound").addEventListener("click",(function(e){var t=e.target,n=t.classList.contains(".button-sound");"true"===(t=n?t:t.closest(".button-sound")).dataset.mute?(t.dataset.mute="false",X.setPlay()):(t.dataset.mute="true",X.setPause())})),document.querySelector(".start").addEventListener("click",(function(e){e.target.remove(),X.setPlay(),A(0,"next",!0)})),document.querySelectorAll(".sliders__slider button").forEach((function(e){return e.addEventListener("click",W)})),document.querySelectorAll(".content__close").forEach((function(e){return e.addEventListener("click",O)})),document.querySelector(".burger").addEventListener("click",(function(e){var t=e.target,n=t.classList.contains(".burger");t=n?t:t.closest(".burger");var a=_.playing,i=_.index;if(!a){if(t.classList.toggle("burger_opened"),12===i){A(13,"next")}else{_.prevCameraPosition.endX=m.position.x,_.prevCameraPosition.endY=m.position.y,_.prevCameraPosition.endZ=m.position.z,_.prevCameraPosition.endRX=m.rotation.x,_.prevCameraPosition.endRY=m.rotation.y,_.prevCameraPosition.endRZ=m.rotation.z,_.prevIndex=i;A(12,"next")}}})),document.querySelectorAll("div.menu__item").forEach((function(e){return e.addEventListener("click",D)}));
